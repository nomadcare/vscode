{
  "version": 3,
  "sources": ["../src/extension.ts"],
  "sourcesContent": ["import * as vscode from \"vscode\";\nimport { readFileSync, writeFileSync } from \"fs\";\nimport { join } from \"path\";\n\nexport function activate(ctx: vscode.ExtensionContext) {\n\tconst provider = new VibeCodingViewProvider(ctx.extensionUri);\n\n\tctx.subscriptions.push(\n\t\tvscode.window.registerWebviewViewProvider(\n\t\t\tVibeCodingViewProvider.viewType,\n\t\t\tprovider\n\t\t)\n\t);\n\n\tvscode.commands.executeCommand(\"workbench.view.extension.vibeCoding\");\n\n\tctx.subscriptions.push(\n\t\tvscode.window.onDidChangeActiveTextEditor((editor) => {\n\t\t\tprovider.handleActiveEditorChange(editor);\n\t\t})\n\t);\n\n\tctx.subscriptions.push(\n\t\tvscode.workspace.onDidOpenTextDocument(() => {\n\t\t\tif (vscode.window.visibleTextEditors.length === 0) return;\n\t\t\tprovider.handleActiveEditorChange(vscode.window.activeTextEditor);\n\t\t})\n\t);\n}\n\nexport function deactivate() {}\n\nfunction getNonce(): string {\n\treturn Math.random().toString(36).slice(2, 10);\n}\n\nclass VibeCodingViewProvider implements vscode.WebviewViewProvider {\n\tpublic static readonly viewType = \"vibeCodingView\";\n\n\tprivate _view?: vscode.WebviewView;\n\tprivate _activeFileInfo: {\n\t\turi: vscode.Uri;\n\t\tfileName: string;\n\t\tcontent: string;\n\t} | null = null;\n\n\tconstructor(private readonly extensionUri: vscode.Uri) {}\n\n\tresolveWebviewView(webviewView: vscode.WebviewView) {\n\t\tthis._view = webviewView;\n\t\tconst webview = webviewView.webview;\n\t\tconst nonce = getNonce();\n\n\t\twebview.options = {\n\t\t\tenableScripts: true,\n\t\t\tlocalResourceRoots: [this.extensionUri],\n\t\t};\n\n\t\t// \u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0448\u0430\u0431\u043B\u043E\u043D\u0430\n\t\tconst htmlPath = join(\n\t\t\tthis.extensionUri.fsPath,\n\t\t\t\"src\",\n\t\t\t\"webview\",\n\t\t\t\"index.html\"\n\t\t);\n\t\tconst scriptPath = join(this.extensionUri.fsPath, \"dist\", \"webview.js\");\n\t\tlet html = readFileSync(htmlPath, \"utf8\")\n\t\t\t.replace(/\\$\\{nonce\\}/g, nonce)\n\t\t\t.replace(/\\$\\{cspSource\\}/g, webview.cspSource)\n\t\t\t.replace(\n\t\t\t\t/\\$\\{scriptUri\\}/g,\n\t\t\t\twebview.asWebviewUri(vscode.Uri.file(scriptPath)).toString()\n\t\t\t);\n\n\t\twebviewView.webview.html = html;\n\n\t\t// \u0421\u0440\u0430\u0437\u0443 \u043F\u043E\u0434\u0445\u0432\u0430\u0442\u044B\u0432\u0430\u0435\u043C \u0442\u0435\u043A\u0443\u0449\u0438\u0439 \u0430\u043A\u0442\u0438\u0432\u043D\u044B\u0439 \u0440\u0435\u0434\u0430\u043A\u0442\u043E\u0440\n\t\tthis.handleActiveEditorChange(vscode.window.activeTextEditor);\n\t\tif (this._activeFileInfo) {\n\t\t\tthis.postActiveFile(\n\t\t\t\tthis._activeFileInfo.fileName,\n\t\t\t\tthis._activeFileInfo.content\n\t\t\t);\n\t\t}\n\n\t\twebview.onDidReceiveMessage(async (msg) => {\n\t\t\tswitch (msg.type) {\n\t\t\t\tcase \"getActiveFile\":\n\t\t\t\t\tif (this._activeFileInfo) {\n\t\t\t\t\t\tthis.postActiveFile(\n\t\t\t\t\t\t\tthis._activeFileInfo.fileName,\n\t\t\t\t\t\t\tthis._activeFileInfo.content\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"simulate\":\n\t\t\t\t\tif (this._activeFileInfo) {\n\t\t\t\t\t\tconst { uri, content } = this._activeFileInfo;\n\t\t\t\t\t\tconst header = `// ${msg.model} \u0441\u0433\u0435\u043D\u0435\u0440\u0438\u0440\u043E\u0432\u0430\u043B \u0447\u0442\u043E-\u0442\u043E\\n`;\n\t\t\t\t\t\tconst newContent = header + content;\n\t\t\t\t\t\twriteFileSync(uri.fsPath, newContent, \"utf8\");\n\t\t\t\t\t\tthis._activeFileInfo.content = newContent;\n\t\t\t\t\t\tthis.postActiveFile(this._activeFileInfo.fileName, newContent);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst randomHtml = `\n            <div style=\"padding:20px;background:#${Math.floor(\n\t\t\t\t\t\t\tMath.random() * 0xffffff\n\t\t\t\t\t\t).toString(16)}\">\n              <h1>Random Preview</h1>\n              <p>Prompt was: \"${msg.prompt}\"</p>\n            </div>\n            <div style=\"padding:8px 12px; font-size:12px; color:#0f0;\">\n              ${msg.model} \u0441\u0433\u0435\u043D\u0435\u0440\u0438\u0440\u043E\u0432\u0430\u043B \u043E\u0442\u0432\u0435\u0442\n            </div>\n          `;\n\t\t\t\t\tthis._view?.webview.postMessage({\n\t\t\t\t\t\ttype: \"simulateResponse\",\n\t\t\t\t\t\tcode: randomHtml,\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\t}\n\n\tpublic handleActiveEditorChange(editor: vscode.TextEditor | undefined) {\n\t\tif (!editor) {\n\t\t\tthis._activeFileInfo = null;\n\t\t\treturn;\n\t\t}\n\t\tconst doc = editor.document;\n\t\tconst uri = doc.uri;\n\t\tconst fileName = uri.fsPath.split(/[\\/\\\\]/).pop() || \"\";\n\t\tconst content = doc.getText();\n\t\tthis._activeFileInfo = { uri, fileName, content };\n\n\t\tif (this._view) {\n\t\t\tthis.postActiveFile(fileName, content);\n\t\t}\n\t}\n\n\tprivate postActiveFile(fileName: string, content: string) {\n\t\tthis._view?.webview.postMessage({\n\t\t\ttype: \"activeFile\",\n\t\t\tfileName,\n\t\t\tcontent,\n\t\t});\n\t}\n}\n"],
  "mappings": "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",
  "names": []
}
